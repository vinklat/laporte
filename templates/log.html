{% extends 'base.html' %}

{% block title %}Switchboard{% endblock %}

{% block content %}
  <h2>Event log:</h2>
  <div id="log" class="text-monospace"></div>  
{% endblock %}

{% block script %}
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
        namespace = '/events';
        // Connect to the Socket.IO server.
        // The connection URL has the following format:
        //     http[s]://<domain>:<port>[/<namespace>]
        var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);

        // Event handler for new connections.
        socket.on('connect', function() {
         $('#status').html("connected");
        });

        socket.on('disconnect', function() {
         $('#status').html("not connected");
        });

        // Event handler for server sent event data.
        socket.on('event', function(msg) {
            t=new Date().toLocaleString();
            $('#log').append('<br>' + $('<div/>').text(t + " " + msg).html());
        });
    });
</script>
{% endblock %}
