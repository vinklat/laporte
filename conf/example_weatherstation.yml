# example:
# - some sensor sends temperature, relative humidity and pressure
# - the dew point and absolute humidity will be calculated
#
# you can try send fake metrics by curl (rest api):
#   curl http://localhost:9128/api/metric/weather1 -d "temp_celsius=37.5" -d "hum_ratio=0.8" -d "relpress_hectopascals=1001" -X PUT
#
# look at the result (Firefox recommended for json response):
#   http://localhost:9128/api/metrics/by_node


virtual:
    weather1:
        addr: "0"
        sensors:
            temp_celsius: gauge
            hum_ratio: gauge
            relpress_hectopascals: gauge
            dew_celsius: gauge
            hum_grams: gauge

        # the following metrics will be calculated
        eval:
            dew_celsius: >
                l = log(hum_ratio);
                m = 17.27 * temp_celsius;
                n = temp_celsius + 237.3;
                b = (l + (m / n)) / 17.27;
                (237.3 * b) / (1 - b)
            hum_grams: >
                t =  8.1332 - (1762.39 / (dew_celsius + 235.66));
                ((10**t) / 760.0) * 1000 * 18.0 / 22.4

        # if ttl is set:
        #   - all metrics will expire if they are not updated within ttl
        #   - there will be a gap in the charts when it comes down
        # if ttl is not set:
        #   - the last value will cover an indeterminate state if the sensor goes out
        ttl: 300
